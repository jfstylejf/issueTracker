package cn.edu.fudan.issueservice.core.process;

import cn.edu.fudan.issueservice.component.RestInterfaceManager;
import cn.edu.fudan.issueservice.dao.IssueIgnoreDao;
import cn.edu.fudan.issueservice.domain.dbo.RawIssue;
import cn.edu.fudan.issueservice.util.JGitHelper;
import com.alibaba.fastjson.JSONArray;
import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.mockito.InjectMocks;
import org.mockito.MockitoAnnotations;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;

import java.lang.reflect.Field;
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

/**
 * @author beethoven
 * @date 2021-03-02 20:07:08
 */
@RunWith(SpringJUnit4ClassRunner.class)
@SpringBootTest
public class IssueStatisticsTest {

    @InjectMocks
    private IssueStatistics issueStatistics;

    @Autowired
    private RestInterfaceManager restInterfaceManager;

    @Autowired
    private IssueIgnoreDao issueIgnoreDao;

    private final JGitHelper jGitHelper = new JGitHelper("/Users/beethoven/Desktop/saic/forTest");

    @Before
    public void setUp() {
        MockitoAnnotations.initMocks(this);
        issueStatistics.setJGitHelper(jGitHelper);
    }

    @Test
    public void ignoreMatchTest() throws NoSuchMethodException, InvocationTargetException, IllegalAccessException, NoSuchFieldException {
        Class<? extends IssueStatistics> issueStatisticsClass = issueStatistics.getClass();
        Method ignoreMatch = issueStatisticsClass.getDeclaredMethod("ignoreMatch", List.class, String.class, Map.class);
        //inject static field
        Field restInterfaceManagerField = issueStatisticsClass.getDeclaredField("restInterfaceManager");
        restInterfaceManagerField.setAccessible(true);
        restInterfaceManagerField.set(issueStatistics, restInterfaceManager);
        Field issueIgnoreDaoField = issueStatisticsClass.getDeclaredField("issueIgnoreDao");
        issueIgnoreDaoField.setAccessible(true);
        issueIgnoreDaoField.set(issueStatistics, issueIgnoreDao);
        //inject commit id
        jGitHelper.checkout("53d057f0419fb3dab5372a4f95c98d1d2fcb09aa");
        issueStatistics.setCommitId("53d057f0419fb3dab5372a4f95c98d1d2fcb09aa");
        //mock data
        String rawIssuesStr = "[{\"codeLines\":0,\"commitId\":\"53d057f0419fb3dab5372a4f95c98d1d2fcb09aa\",\"detail\":\"Return an empty collection instead of null.---CRITICAL\",\"developerName\":\"shaoxi\",\"fileName\":\"src/main/java/application/com/jGitHelperTest/addFileTest1.java\",\"locations\":[{\"bugLines\":\"11\",\"code\":\"        return null;\",\"endLine\":11,\"endToken\":0,\"filePath\":\"src/main/java/application/com/jGitHelperTest/addFileTest1.java\",\"locationMatchResults\":[],\"matched\":false,\"matchedIndex\":-1,\"methodName\":\"get()\",\"offset\":1,\"rawIssueId\":\"6973f45a-e5fc-4bf6-81c8-08dcf6aa2958\",\"startLine\":11,\"startToken\":0,\"tokens\":[-49,-55],\"uuid\":\"417e0319-75ed-4677-bec4-ca992a85a332\"}],\"mapped\":false,\"matchDegree\":0.0,\"matchInfos\":[],\"matchResultDTOIndex\":-1,\"notChange\":false,\"onceMapped\":false,\"priority\":1,\"rawIssueMatchResults\":[],\"realEliminate\":false,\"repoId\":\"3b1f56e8-69c9-11eb-b829-432f1e48d2fb\",\"scanId\":\"sonarqube\",\"status\":\"default\",\"tool\":\"sonarqube\",\"type\":\"Empty arrays and collections should be returned instead of null\",\"uuid\":\"6973f45a-e5fc-4bf6-81c8-08dcf6aa2958\",\"version\":1},{\"codeLines\":0,\"commitId\":\"53d057f0419fb3dab5372a4f95c98d1d2fcb09aa\",\"detail\":\"Define a constant instead of duplicating this literal \\\"test location\\\" 3 times.---MINOR\",\"developerName\":\"shaoxi\",\"fileName\":\"src/main/java/application/issue/multiple/location/AddLine.java\",\"locations\":[{\"bugLines\":\"11\",\"code\":\"        System.out.println(\\\"test location\\\");\",\"endLine\":11,\"endToken\":0,\"filePath\":\"src/main/java/application/issue/multiple/location/AddLine.java\",\"locationMatchResults\":[],\"matched\":false,\"matchedIndex\":-1,\"methodName\":\"a()\",\"offset\":1,\"rawIssueId\":\"0a0f18e9-240f-4cb7-83bb-83c57402ab68\",\"startLine\":11,\"startToken\":0,\"tokens\":[-66,-32,-51,-30,-54],\"uuid\":\"547ac9aa-c2d6-4df2-80b3-fe5310c6977a\"},{\"bugLines\":\"15\",\"code\":\"        System.out.println(\\\"test location\\\");\",\"endLine\":15,\"endToken\":0,\"filePath\":\"src/main/java/application/issue/multiple/location/AddLine.java\",\"locationMatchResults\":[],\"matched\":false,\"matchedIndex\":-1,\"methodName\":\"b()\",\"offset\":1,\"rawIssueId\":\"0a0f18e9-240f-4cb7-83bb-83c57402ab68\",\"startLine\":15,\"startToken\":0,\"tokens\":[-66,-32,-51,-30,-54],\"uuid\":\"595cc78e-70df-4d76-a264-51f096ecc473\"},{\"bugLines\":\"19\",\"code\":\"        System.out.println(\\\"test location\\\");\",\"endLine\":19,\"endToken\":0,\"filePath\":\"src/main/java/application/issue/multiple/location/AddLine.java\",\"locationMatchResults\":[],\"matched\":false,\"matchedIndex\":-1,\"methodName\":\"c()\",\"offset\":1,\"rawIssueId\":\"0a0f18e9-240f-4cb7-83bb-83c57402ab68\",\"startLine\":19,\"startToken\":0,\"tokens\":[-66,-32,-51,-30,-54],\"uuid\":\"484d1526-d512-464d-bc24-fbe49b9a39dd\"}],\"mapped\":false,\"matchDegree\":0.0,\"matchInfos\":[],\"matchResultDTOIndex\":-1,\"notChange\":false,\"onceMapped\":false,\"priority\":3,\"rawIssueMatchResults\":[],\"realEliminate\":false,\"repoId\":\"3b1f56e8-69c9-11eb-b829-432f1e48d2fb\",\"scanId\":\"sonarqube\",\"status\":\"default\",\"tool\":\"sonarqube\",\"type\":\"String literals should not be duplicated\",\"uuid\":\"0a0f18e9-240f-4cb7-83bb-83c57402ab68\",\"version\":1},{\"codeLines\":0,\"commitId\":\"53d057f0419fb3dab5372a4f95c98d1d2fcb09aa\",\"detail\":\"Define a constant instead of duplicating this literal \\\"class\\\" 3 times.---MINOR\",\"developerName\":\"shaoxi\",\"fileName\":\"src/main/java/application/issue/multiple/location/ClassNameChange.java\",\"locations\":[{\"bugLines\":\"10\",\"code\":\"            System.out.println(\\\"class\\\");\",\"endLine\":10,\"endToken\":0,\"filePath\":\"src/main/java/application/issue/multiple/location/ClassNameChange.java\",\"locationMatchResults\":[],\"matched\":false,\"matchedIndex\":-1,\"methodName\":\"a()\",\"offset\":1,\"rawIssueId\":\"c45d5545-71b3-4bee-9704-9a3cb8a187f6\",\"startLine\":10,\"startToken\":0,\"tokens\":[-66,-32,-51,-24],\"uuid\":\"17296e1a-ad51-4b6f-a7bf-29b3c0876dff\"},{\"bugLines\":\"11\",\"code\":\"            System.out.println(\\\"class\\\");\",\"endLine\":11,\"endToken\":0,\"filePath\":\"src/main/java/application/issue/multiple/location/ClassNameChange.java\",\"locationMatchResults\":[],\"matched\":false,\"matchedIndex\":-1,\"methodName\":\"a()\",\"offset\":1,\"rawIssueId\":\"c45d5545-71b3-4bee-9704-9a3cb8a187f6\",\"startLine\":11,\"startToken\":0,\"tokens\":[-66,-32,-51,-24],\"uuid\":\"f7a40ad6-2151-440c-b6e3-c96114d855f7\"},{\"bugLines\":\"12\",\"code\":\"            System.out.println(\\\"class\\\");\",\"endLine\":12,\"endToken\":0,\"filePath\":\"src/main/java/application/issue/multiple/location/ClassNameChange.java\",\"locationMatchResults\":[],\"matched\":false,\"matchedIndex\":-1,\"methodName\":\"a()\",\"offset\":1,\"rawIssueId\":\"c45d5545-71b3-4bee-9704-9a3cb8a187f6\",\"startLine\":12,\"startToken\":0,\"tokens\":[-66,-32,-51,-24],\"uuid\":\"0404ad43-d0dd-4616-b227-23823ed63753\"}],\"mapped\":false,\"matchDegree\":0.0,\"matchInfos\":[],\"matchResultDTOIndex\":-1,\"notChange\":false,\"onceMapped\":false,\"priority\":3,\"rawIssueMatchResults\":[],\"realEliminate\":false,\"repoId\":\"3b1f56e8-69c9-11eb-b829-432f1e48d2fb\",\"scanId\":\"sonarqube\",\"status\":\"default\",\"tool\":\"sonarqube\",\"type\":\"String literals should not be duplicated\",\"uuid\":\"c45d5545-71b3-4bee-9704-9a3cb8a187f6\",\"version\":1},{\"codeLines\":0,\"commitId\":\"53d057f0419fb3dab5372a4f95c98d1d2fcb09aa\",\"detail\":\"Define a constant instead of duplicating this literal \\\"test location\\\" 3 times.---MINOR\",\"developerName\":\"shaoxi\",\"fileName\":\"src/main/java/application/issue/multiple/location/DelLine.java\",\"locations\":[{\"bugLines\":\"12\",\"code\":\"        System.out.println(\\\"test location\\\");\",\"endLine\":12,\"endToken\":0,\"filePath\":\"src/main/java/application/issue/multiple/location/DelLine.java\",\"locationMatchResults\":[],\"matched\":false,\"matchedIndex\":-1,\"methodName\":\"a()\",\"offset\":1,\"rawIssueId\":\"351c38bc-8e60-428a-a937-33f186f904d3\",\"startLine\":12,\"startToken\":0,\"tokens\":[-66,-32,-51,-30,-54],\"uuid\":\"6aecf8cd-9a71-4e2f-afbd-bd4af83e0f3e\"},{\"bugLines\":\"16\",\"code\":\"        System.out.println(\\\"test location\\\");\",\"endLine\":16,\"endToken\":0,\"filePath\":\"src/main/java/application/issue/multiple/location/DelLine.java\",\"locationMatchResults\":[],\"matched\":false,\"matchedIndex\":-1,\"methodName\":\"b()\",\"offset\":1,\"rawIssueId\":\"351c38bc-8e60-428a-a937-33f186f904d3\",\"startLine\":16,\"startToken\":0,\"tokens\":[-66,-32,-51,-30,-54],\"uuid\":\"f4ddc9e2-cf44-48ec-8ade-6d3f130f52da\"},{\"bugLines\":\"20\",\"code\":\"        System.out.println(\\\"test location\\\");\",\"endLine\":20,\"endToken\":0,\"filePath\":\"src/main/java/application/issue/multiple/location/DelLine.java\",\"locationMatchResults\":[],\"matched\":false,\"matchedIndex\":-1,\"methodName\":\"c()\",\"offset\":1,\"rawIssueId\":\"351c38bc-8e60-428a-a937-33f186f904d3\",\"startLine\":20,\"startToken\":0,\"tokens\":[-66,-32,-51,-30,-54],\"uuid\":\"2af6cb63-8bf6-4672-baa4-c18b9c046fea\"}],\"mapped\":false,\"matchDegree\":0.0,\"matchInfos\":[],\"matchResultDTOIndex\":-1,\"notChange\":false,\"onceMapped\":false,\"priority\":3,\"rawIssueMatchResults\":[],\"realEliminate\":false,\"repoId\":\"3b1f56e8-69c9-11eb-b829-432f1e48d2fb\",\"scanId\":\"sonarqube\",\"status\":\"default\",\"tool\":\"sonarqube\",\"type\":\"String literals should not be duplicated\",\"uuid\":\"351c38bc-8e60-428a-a937-33f186f904d3\",\"version\":1},{\"codeLines\":0,\"commitId\":\"53d057f0419fb3dab5372a4f95c98d1d2fcb09aa\",\"detail\":\"Define a constant instead of duplicating this literal \\\"method1\\\" 3 times.---MINOR\",\"developerName\":\"shaoxi\",\"fileName\":\"src/main/java/application/issue/multiple/location/MethodName.java\",\"locations\":[{\"bugLines\":\"9\",\"code\":\"        System.out.println(\\\"method1\\\");\",\"endLine\":9,\"endToken\":0,\"filePath\":\"src/main/java/application/issue/multiple/location/MethodName.java\",\"locationMatchResults\":[],\"matched\":false,\"matchedIndex\":-1,\"methodName\":\"method4(int, int)\",\"offset\":1,\"rawIssueId\":\"06166ae6-6962-4871-a71b-250e8f3c3bf0\",\"startLine\":9,\"startToken\":0,\"tokens\":[-66,-32,-51,-9],\"uuid\":\"ff2e2e39-2cbd-480a-9e80-92f4bc8f25db\"},{\"bugLines\":\"12\",\"code\":\"        System.out.println(\\\"method1\\\");\",\"endLine\":12,\"endToken\":0,\"filePath\":\"src/main/java/application/issue/multiple/location/MethodName.java\",\"locationMatchResults\":[],\"matched\":false,\"matchedIndex\":-1,\"methodName\":\"method5(int, int)\",\"offset\":1,\"rawIssueId\":\"06166ae6-6962-4871-a71b-250e8f3c3bf0\",\"startLine\":12,\"startToken\":0,\"tokens\":[-66,-32,-51,-9],\"uuid\":\"fbcd6356-3c06-4e08-9793-9a12ea45231f\"},{\"bugLines\":\"15\",\"code\":\"        System.out.println(\\\"method1\\\");\",\"endLine\":15,\"endToken\":0,\"filePath\":\"src/main/java/application/issue/multiple/location/MethodName.java\",\"locationMatchResults\":[],\"matched\":false,\"matchedIndex\":-1,\"methodName\":\"method6(int, int)\",\"offset\":1,\"rawIssueId\":\"06166ae6-6962-4871-a71b-250e8f3c3bf0\",\"startLine\":15,\"startToken\":0,\"tokens\":[-66,-32,-51,-9],\"uuid\":\"5711c87d-4789-41f9-82b1-017019cc5ad9\"}],\"mapped\":false,\"matchDegree\":0.0,\"matchInfos\":[],\"matchResultDTOIndex\":-1,\"notChange\":false,\"onceMapped\":false,\"priority\":3,\"rawIssueMatchResults\":[],\"realEliminate\":false,\"repoId\":\"3b1f56e8-69c9-11eb-b829-432f1e48d2fb\",\"scanId\":\"sonarqube\",\"status\":\"default\",\"tool\":\"sonarqube\",\"type\":\"String literals should not be duplicated\",\"uuid\":\"06166ae6-6962-4871-a71b-250e8f3c3bf0\",\"version\":1},{\"codeLines\":0,\"commitId\":\"53d057f0419fb3dab5372a4f95c98d1d2fcb09aa\",\"detail\":\"Define a constant instead of duplicating this literal \\\"method2\\\" 3 times.---MINOR\",\"developerName\":\"shaoxi\",\"fileName\":\"src/main/java/application/issue/multiple/location/MethodName.java\",\"locations\":[{\"bugLines\":\"18\",\"code\":\"        System.out.println(\\\"method2\\\");\",\"endLine\":18,\"endToken\":0,\"filePath\":\"src/main/java/application/issue/multiple/location/MethodName.java\",\"locationMatchResults\":[],\"matched\":false,\"matchedIndex\":-1,\"methodName\":\"method7(int)\",\"offset\":1,\"rawIssueId\":\"01dda538-e4a0-404f-84b6-899365ba6444\",\"startLine\":18,\"startToken\":0,\"tokens\":[-66,-32,-51,-3],\"uuid\":\"9714da31-d4d6-46f4-ae27-3f9b6222e085\"},{\"bugLines\":\"21\",\"code\":\"        System.out.println(\\\"method2\\\");\",\"endLine\":21,\"endToken\":0,\"filePath\":\"src/main/java/application/issue/multiple/location/MethodName.java\",\"locationMatchResults\":[],\"matched\":false,\"matchedIndex\":-1,\"methodName\":\"method8(int)\",\"offset\":1,\"rawIssueId\":\"01dda538-e4a0-404f-84b6-899365ba6444\",\"startLine\":21,\"startToken\":0,\"tokens\":[-66,-32,-51,-3],\"uuid\":\"e6bda294-2787-49ec-a706-7e3d7c48241d\"},{\"bugLines\":\"24\",\"code\":\"        System.out.println(\\\"method2\\\");\",\"endLine\":24,\"endToken\":0,\"filePath\":\"src/main/java/application/issue/multiple/location/MethodName.java\",\"locationMatchResults\":[],\"matched\":false,\"matchedIndex\":-1,\"methodName\":\"method9(int)\",\"offset\":1,\"rawIssueId\":\"01dda538-e4a0-404f-84b6-899365ba6444\",\"startLine\":24,\"startToken\":0,\"tokens\":[-66,-32,-51,-3],\"uuid\":\"ac6b9b30-7b91-4445-9596-19298096c3fc\"}],\"mapped\":false,\"matchDegree\":0.0,\"matchInfos\":[],\"matchResultDTOIndex\":-1,\"notChange\":false,\"onceMapped\":false,\"priority\":3,\"rawIssueMatchResults\":[],\"realEliminate\":false,\"repoId\":\"3b1f56e8-69c9-11eb-b829-432f1e48d2fb\",\"scanId\":\"sonarqube\",\"status\":\"default\",\"tool\":\"sonarqube\",\"type\":\"String literals should not be duplicated\",\"uuid\":\"01dda538-e4a0-404f-84b6-899365ba6444\",\"version\":1},{\"codeLines\":0,\"commitId\":\"53d057f0419fb3dab5372a4f95c98d1d2fcb09aa\",\"detail\":\"Return an empty collection instead of null.---CRITICAL\",\"developerName\":\"shaoxi\",\"fileName\":\"src/main/java/application/issue/single/location/AddLine.java\",\"locations\":[{\"bugLines\":\"16\",\"code\":\"        return null;\",\"endLine\":16,\"endToken\":0,\"filePath\":\"src/main/java/application/issue/single/location/AddLine.java\",\"locationMatchResults\":[],\"matched\":false,\"matchedIndex\":-1,\"methodName\":\"addLineTest()\",\"offset\":1,\"rawIssueId\":\"50066ee1-59ec-4dc6-882b-0b2e752f7c89\",\"startLine\":16,\"startToken\":0,\"tokens\":[-49,-55],\"uuid\":\"1a12185f-4dec-4c88-885a-3731b8492ef9\"}],\"mapped\":false,\"matchDegree\":0.0,\"matchInfos\":[],\"matchResultDTOIndex\":-1,\"notChange\":false,\"onceMapped\":false,\"priority\":1,\"rawIssueMatchResults\":[],\"realEliminate\":false,\"repoId\":\"3b1f56e8-69c9-11eb-b829-432f1e48d2fb\",\"scanId\":\"sonarqube\",\"status\":\"default\",\"tool\":\"sonarqube\",\"type\":\"Empty arrays and collections should be returned instead of null\",\"uuid\":\"50066ee1-59ec-4dc6-882b-0b2e752f7c89\",\"version\":1},{\"codeLines\":0,\"commitId\":\"53d057f0419fb3dab5372a4f95c98d1d2fcb09aa\",\"detail\":\"Return an empty collection instead of null.---CRITICAL\",\"developerName\":\"shaoxi\",\"fileName\":\"src/main/java/application/issue/single/location/AddLine.java\",\"locations\":[{\"bugLines\":\"20\",\"code\":\"        return null;\",\"endLine\":20,\"endToken\":0,\"filePath\":\"src/main/java/application/issue/single/location/AddLine.java\",\"locationMatchResults\":[],\"matched\":false,\"matchedIndex\":-1,\"methodName\":\"addLineIgnore()\",\"offset\":1,\"rawIssueId\":\"6a5398aa-b3dc-4922-a2de-ad036125c3ba\",\"startLine\":20,\"startToken\":0,\"tokens\":[-49,-55],\"uuid\":\"901cb07e-b738-4d22-8882-176ef97a2e76\"}],\"mapped\":false,\"matchDegree\":0.0,\"matchInfos\":[],\"matchResultDTOIndex\":-1,\"notChange\":false,\"onceMapped\":false,\"priority\":1,\"rawIssueMatchResults\":[],\"realEliminate\":false,\"repoId\":\"3b1f56e8-69c9-11eb-b829-432f1e48d2fb\",\"scanId\":\"sonarqube\",\"status\":\"default\",\"tool\":\"sonarqube\",\"type\":\"Empty arrays and collections should be returned instead of null\",\"uuid\":\"6a5398aa-b3dc-4922-a2de-ad036125c3ba\",\"version\":1},{\"codeLines\":0,\"commitId\":\"53d057f0419fb3dab5372a4f95c98d1d2fcb09aa\",\"detail\":\"Return an empty collection instead of null.---CRITICAL\",\"developerName\":\"shaoxi\",\"fileName\":\"src/main/java/application/issue/single/location/ClassNameChange.java\",\"locations\":[{\"bugLines\":\"14\",\"code\":\"            return null;\",\"endLine\":14,\"endToken\":0,\"filePath\":\"src/main/java/application/issue/single/location/ClassNameChange.java\",\"locationMatchResults\":[],\"matched\":false,\"matchedIndex\":-1,\"methodName\":\"classNameChange()\",\"offset\":1,\"rawIssueId\":\"8603488f-89ae-444d-8917-fd215f9bf9a8\",\"startLine\":14,\"startToken\":0,\"tokens\":[-49,-55],\"uuid\":\"fd4f2d5b-3dad-48e2-b02f-4e5122043aff\"}],\"mapped\":false,\"matchDegree\":0.0,\"matchInfos\":[],\"matchResultDTOIndex\":-1,\"notChange\":false,\"onceMapped\":false,\"priority\":1,\"rawIssueMatchResults\":[],\"realEliminate\":false,\"repoId\":\"3b1f56e8-69c9-11eb-b829-432f1e48d2fb\",\"scanId\":\"sonarqube\",\"status\":\"default\",\"tool\":\"sonarqube\",\"type\":\"Empty arrays and collections should be returned instead of null\",\"uuid\":\"8603488f-89ae-444d-8917-fd215f9bf9a8\",\"version\":1},{\"codeLines\":0,\"commitId\":\"53d057f0419fb3dab5372a4f95c98d1d2fcb09aa\",\"detail\":\"Return an empty collection instead of null.---CRITICAL\",\"developerName\":\"shaoxi\",\"fileName\":\"src/main/java/application/issue/single/location/DelLine.java\",\"locations\":[{\"bugLines\":\"13\",\"code\":\"        return null;\",\"endLine\":13,\"endToken\":0,\"filePath\":\"src/main/java/application/issue/single/location/DelLine.java\",\"locationMatchResults\":[],\"matched\":false,\"matchedIndex\":-1,\"methodName\":\"deleteLineTest()\",\"offset\":1,\"rawIssueId\":\"bcece3c5-bf2a-4a54-8184-fec5a80ddec7\",\"startLine\":13,\"startToken\":0,\"tokens\":[-49,-55],\"uuid\":\"1f92a34a-2ecb-444d-8209-d6f373206a90\"}],\"mapped\":false,\"matchDegree\":0.0,\"matchInfos\":[],\"matchResultDTOIndex\":-1,\"notChange\":false,\"onceMapped\":false,\"priority\":1,\"rawIssueMatchResults\":[],\"realEliminate\":false,\"repoId\":\"3b1f56e8-69c9-11eb-b829-432f1e48d2fb\",\"scanId\":\"sonarqube\",\"status\":\"default\",\"tool\":\"sonarqube\",\"type\":\"Empty arrays and collections should be returned instead of null\",\"uuid\":\"bcece3c5-bf2a-4a54-8184-fec5a80ddec7\",\"version\":1},{\"codeLines\":0,\"commitId\":\"53d057f0419fb3dab5372a4f95c98d1d2fcb09aa\",\"detail\":\"Return an empty collection instead of null.---CRITICAL\",\"developerName\":\"shaoxi\",\"fileName\":\"src/main/java/application/issue/single/location/MethodName.java\",\"locations\":[{\"bugLines\":\"14\",\"code\":\"        return null;\",\"endLine\":14,\"endToken\":0,\"filePath\":\"src/main/java/application/issue/single/location/MethodName.java\",\"locationMatchResults\":[],\"matched\":false,\"matchedIndex\":-1,\"methodName\":\"MethodNameChange2()\",\"offset\":1,\"rawIssueId\":\"d0d9129d-821d-4e16-bca6-0f71327e73b4\",\"startLine\":14,\"startToken\":0,\"tokens\":[-49,-55],\"uuid\":\"c4da2425-796d-4a9a-a0ac-b447048bcddc\"}],\"mapped\":false,\"matchDegree\":0.0,\"matchInfos\":[],\"matchResultDTOIndex\":-1,\"notChange\":false,\"onceMapped\":false,\"priority\":1,\"rawIssueMatchResults\":[],\"realEliminate\":false,\"repoId\":\"3b1f56e8-69c9-11eb-b829-432f1e48d2fb\",\"scanId\":\"sonarqube\",\"status\":\"default\",\"tool\":\"sonarqube\",\"type\":\"Empty arrays and collections should be returned instead of null\",\"uuid\":\"d0d9129d-821d-4e16-bca6-0f71327e73b4\",\"version\":1},{\"codeLines\":0,\"commitId\":\"53d057f0419fb3dab5372a4f95c98d1d2fcb09aa\",\"detail\":\"Return an empty collection instead of null.---CRITICAL\",\"developerName\":\"shaoxi\",\"fileName\":\"src/main/java/application/issue/single/location/MethodName.java\",\"locations\":[{\"bugLines\":\"18\",\"code\":\"        return null;\",\"endLine\":18,\"endToken\":0,\"filePath\":\"src/main/java/application/issue/single/location/MethodName.java\",\"locationMatchResults\":[],\"matched\":false,\"matchedIndex\":-1,\"methodName\":\"MethodNameChange2(int)\",\"offset\":1,\"rawIssueId\":\"a188e511-c6ce-4f45-8919-21d03bd969a5\",\"startLine\":18,\"startToken\":0,\"tokens\":[-49,-55],\"uuid\":\"e49db8d7-5595-417f-852d-fe2664a7e37e\"}],\"mapped\":false,\"matchDegree\":0.0,\"matchInfos\":[],\"matchResultDTOIndex\":-1,\"notChange\":false,\"onceMapped\":false,\"priority\":1,\"rawIssueMatchResults\":[],\"realEliminate\":false,\"repoId\":\"3b1f56e8-69c9-11eb-b829-432f1e48d2fb\",\"scanId\":\"sonarqube\",\"status\":\"default\",\"tool\":\"sonarqube\",\"type\":\"Empty arrays and collections should be returned instead of null\",\"uuid\":\"a188e511-c6ce-4f45-8919-21d03bd969a5\",\"version\":1}]\n";
        List<RawIssue> rawIssues = JSONArray.parseArray(rawIssuesStr, RawIssue.class);
        Map<String, String> map = new HashMap<>(16);
        //violence reflected
        ignoreMatch.setAccessible(true);
        ignoreMatch.invoke(issueStatistics, rawIssues, "3b1f56e8-69c9-11eb-b829-432f1e48d2fb", map);
        //Assert.assertEquals(map.size(), 3);
    }
}
